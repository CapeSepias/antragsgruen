{"version":3,"sources":["backend/AmendmentEdit.ts"],"names":["AmendmentEdit","this","lang","$","attr","$editTextCaller","datetimepicker","locale","find","click","textEditCalled","bind","submit","ev","data","confirmed","$form","preventDefault","bootbox","confirm","__t","result","trigger","MotionSupporterEdit_1","MotionSupporterEdit","prototype","textEditCalledMultiPara","each","$holder","$textarea","editor","AntragsgruenEditor_1","AntragsgruenEditor","ckeditor","getEditor","parents","parent","val","getData","plugins","lite","findPlugin","acceptAll","addClass","removeClass","AmendmentEditSinglePara_1","AmendmentEditSinglePara","append"],"mappings":"kOAuEA,IAjEA,WAkCI,QAAAA,KACIC,KAAKC,KAAOC,EAAE,QAAQC,KAAK,QAC3BH,KAAKI,gBAAkBF,EAAE,4BAEzBA,EAAE,gCAAgCG,gBAC9BC,OAAQN,KAAKC,OAEjBC,EAAE,kCAAkCG,gBAChCC,OAAQN,KAAKC,OAIjBD,KAAKI,gBAAgBG,KAAK,UAAUC,MAAMR,KAAKS,eAAeC,KAAKV,OAEnEE,EAAE,wBAAwBS,OAAO,SAAUC,EAAIC,GAC3C,IAAIA,IAAeA,EAAc,UAArB,KAA6C,IAAnBA,EAAKC,UAA3C,CAGA,GAAIC,GAAQb,EAAEF,KACdY,GAAGI,iBACHC,QAAQC,QAAQC,IAAI,QAAS,uBAAwB,SAAUC,GACvDA,GACAL,EAAMM,QAAQ,UAAWP,WAAa,SAKlD,GAAIQ,GAAAC,oBAAoBrB,EAAE,2BAElC,MA1DYH,GAAAyB,UAAAC,wBAAR,WACIvB,EAAE,qBAAqBwB,KAAK,WACxB,GAAIC,GAAUzB,EAAEF,MACZ4B,EAAYD,EAAQpB,KAAK,eAEzBsB,EAA6B,GAAIC,GAAAC,mBAAmBH,EAAUzB,KAAK,OACnE6B,EAAmBH,EAAOI,WAE9BL,GAAUM,QAAQ,QAAQvB,OAAO,WAC7BiB,EAAUO,SAAS5B,KAAK,gBAAgB6B,IAAIJ,EAASK,eAChB,KAA1BL,EAASM,QAAY,OAC5BN,EAASM,QAAQC,KAAKC,WAAWR,GAAUS,YAC3Cb,EAAUO,SAAS5B,KAAK,yBAAyB6B,IAAIJ,EAASK,iBAMtEtC,EAAAyB,UAAAf,eAAR,WACIT,KAAKI,gBAAgBsC,SAAS,UAC9BxC,EAAE,4BAA4ByC,YAAY,UACtC3C,KAAKI,gBAAgBS,KAAK,uBAC1Bb,KAAKyB,0BAEL,GAAImB,GAAAC,wBAER3C,EAAE,wBAAwB4C,OAAO,oDAgCzC/C","file":"AmendmentEdit.js","sourcesContent":["import \"./MotionSupporterEdit\";\nimport {MotionSupporterEdit} from \"./MotionSupporterEdit\";\nimport {AntragsgruenEditor} from \"../shared/AntragsgruenEditor\";\nimport editor = CKEDITOR.editor;\nimport {AmendmentEditSinglePara} from \"../shared/AmendmentEditSinglePara\";\n\nclass AmendmentEdit {\n    private lang: string;\n\n    private $editTextCaller: JQuery;\n\n    private textEditCalledMultiPara() {\n        $(\".wysiwyg-textarea\").each(function () {\n            let $holder = $(this),\n                $textarea = $holder.find(\".texteditor\");\n\n            let editor: AntragsgruenEditor = new AntragsgruenEditor($textarea.attr(\"id\")),\n                ckeditor: editor = editor.getEditor();\n\n            $textarea.parents(\"form\").submit(function () {\n                $textarea.parent().find(\"textarea.raw\").val(ckeditor.getData());\n                if (typeof(ckeditor.plugins.lite) != 'undefined') {\n                    ckeditor.plugins.lite.findPlugin(ckeditor).acceptAll();\n                    $textarea.parent().find(\"textarea.consolidated\").val(ckeditor.getData());\n                }\n            });\n        });\n    }\n\n    private textEditCalled() {\n        this.$editTextCaller.addClass(\"hidden\");\n        $(\"#amendmentTextEditHolder\").removeClass(\"hidden\");\n        if (this.$editTextCaller.data(\"multiple-paragraphs\")) {\n            this.textEditCalledMultiPara();\n        } else {\n            new AmendmentEditSinglePara();\n        }\n        $(\"#amendmentUpdateForm\").append(\"<input type='hidden' name='edittext' value='1'>\");\n    };\n\n    constructor() {\n        this.lang = $(\"html\").attr(\"lang\");\n        this.$editTextCaller = $(\"#amendmentTextEditCaller\");\n\n        $(\"#amendmentDateCreationHolder\").datetimepicker({\n            locale: this.lang\n        });\n        $(\"#amendmentDateResolutionHolder\").datetimepicker({\n            locale: this.lang\n        });\n\n\n        this.$editTextCaller.find(\"button\").click(this.textEditCalled.bind(this));\n\n        $(\".amendmentDeleteForm\").submit(function (ev, data) {\n            if (data && typeof(data.confirmed) && data.confirmed === true) {\n                return;\n            }\n            let $form = $(this);\n            ev.preventDefault();\n            bootbox.confirm(__t(\"admin\", \"delAmendmentConfirm\"), function (result) {\n                if (result) {\n                    $form.trigger(\"submit\", {'confirmed': true});\n                }\n            });\n        });\n\n        new MotionSupporterEdit($(\"#motionSupporterHolder\"));\n    }\n}\n\nnew AmendmentEdit();\n"]}