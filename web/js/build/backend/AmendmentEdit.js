define(["require","exports","./MotionSupporterEdit","../shared/AntragsgruenEditor","../shared/AmendmentEditSinglePara","./MotionSupporterEdit"],(function(t,e,n,a,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AmendmentEdit=void 0;e.AmendmentEdit=class{constructor(){this.lang=$("html").attr("lang"),this.$updateForm=$("#amendmentUpdateForm"),this.$status=$("#amendmentStatus"),this.$editTextCaller=$("#amendmentTextEditCaller"),$("#amendmentDateCreationHolder").datetimepicker({locale:this.lang}),$("#amendmentDateResolutionHolder").datetimepicker({locale:this.lang}),$("#resolutionDateHolder").datetimepicker({locale:$("#resolutionDate").data("locale"),format:"L"}),this.$editTextCaller.find("button").on("click",this.textEditCalled.bind(this)),$(".wysiwyg-textarea .resetText").on("click",(t=>{let e=$(t.currentTarget).parents(".wysiwyg-textarea").find(".texteditor");window.CKEDITOR.instances[e.attr("id")].setData(e.data("original-html")),$(t.currentTarget).parents(".modifiedActions").addClass("hidden")})),$(".amendmentDeleteForm").on("submit",(function(t,e){if(e&&(e.confirmed,1)&&!0===e.confirmed)return;let n=$(this);t.preventDefault(),bootbox.confirm(__t("admin","delAmendmentConfirm"),(function(t){t&&n.trigger("submit",{confirmed:!0})}))})),this.initVotingFunctions(),new n.MotionSupporterEdit($("#motionSupporterHolder"))}textEditCalledMultiPara(){$(".wysiwyg-textarea").each((function(){let t=$(this).find(".texteditor"),e=new a.AntragsgruenEditor(t.attr("id")).getEditor();t.parents("form").on("submit",(function(){t.parent().find("textarea.raw").val(e.getData()),void 0!==e.plugins.lite&&(e.plugins.lite.findPlugin(e).acceptAll(),t.parent().find("textarea.consolidated").val(e.getData()))}))}))}textEditCalled(){this.$editTextCaller.addClass("hidden"),$("#amendmentTextEditHolder").removeClass("hidden"),this.$editTextCaller.data("multiple-paragraphs")?this.textEditCalledMultiPara():new i.AmendmentEditSinglePara,$("#amendmentUpdateForm").append("<input type='hidden' name='edittext' value='1'>")}initVotingFunctions(){const t=$(".contentVotingResultCaller, .votingDataHolder"),e=$(".votingDataCloser"),n=$(".votingDataOpener"),a=$("select[name=votingBlockId]");n.on("click",(()=>{t.addClass("explicitlyOpened")})),e.on("click",(()=>{t.removeClass("explicitlyOpened")})),this.$status.on("change",(()=>{11===parseInt(this.$status.val(),10)?t.addClass("hasVotingStatus"):t.removeClass("hasVotingStatus")})).trigger("change"),$(".votingItemBlockRow select").on("change",(t=>{const e=$(t.currentTarget);if(e.val()){const t=e.find("option[value="+e.val()+"]").data("group-name");$(".votingItemBlockNameRow input").val(t),$(".votingItemBlockNameRow").removeClass("hidden")}else $(".votingItemBlockNameRow").addClass("hidden")})),a.on("change",(()=>{if("NEW"===a.val())$(".votingBlockRow .newBlock").removeClass("hidden"),$(".votingItemBlockRow").addClass("hidden"),$(".votingItemBlockNameRow").addClass("hidden");else{$(".votingBlockRow .newBlock").addClass("hidden"),$(".votingItemBlockRow").addClass("hidden");const t=$(".votingItemBlockRow"+a.val());t.removeClass("hidden"),t.length>0?(t.removeClass("hidden"),t.find("select").trigger("change")):$(".votingItemBlockNameRow").addClass("hidden")}})).trigger("change")}}}));
//# sourceMappingURL=AmendmentEdit.js.map
