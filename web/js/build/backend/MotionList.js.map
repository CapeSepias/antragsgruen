{"version":3,"sources":["backend/MotionList.ts"],"names":["MotionList","this","initList","initExportRow","prototype","$","click","ev","find","prop","preventDefault","$select","initiatorValues","data","matcher","q","cb","matches","substrRegex","RegExp","each","i","str","test","push","value","options","hint","highlight","minLength","datasets","name","source","typeahead","colResizable","liveDrag","postbackSafe","minWidth","$exportRow","on","stopPropagation","$dd","recalcLinks","withdrawn","link","replace","attr","change","trigger"],"mappings":"AAEA,GAAAA,YAAA,WACI,QAAAA,KACIC,KAAKC,WACLD,KAAKE,gBAyEb,MAtEYH,GAAAI,UAAAF,SAAR,WACIG,EAAE,YAAYC,MAAM,SAAUC,GAC1BF,EAAE,qBAAqBG,KAAK,mBAAmBC,KAAK,WAAW,GAC/DF,EAAGG,mBAEPL,EAAE,aAAaC,MAAM,SAAUC,GAC3BF,EAAE,qBAAqBG,KAAK,mBAAmBC,KAAK,WAAW,GAC/DF,EAAGG,kBAGP,IAAIC,GAAUN,EAAE,oBACZO,EAAkBD,EAAQE,KAAK,UAC/BC,EAAU,SAAqBC,EAAGC,GAC9B,GAAIC,GAASC,CAGbD,MAGAC,EAAc,GAAIC,QAAOJ,EAAG,KAI5BV,EAAEe,KAAKR,EAAiB,SAAUS,EAAGC,GAC7BJ,EAAYK,KAAKD,IAGjBL,EAAQO,MAAMC,MAAOH,MAG7BN,EAAGC,IAGPS,GACAC,MAAM,EACNC,WAAW,EACXC,UAAW,GAEXC,IACAC,KAAM,YACNC,OAAQlB,GAGZH,GAAQsB,UAAeP,EAASI,GAEhCzB,EAAE,qBAAqB6B,cACnBC,UAAY,EACZC,cAAgB,EAChBC,SAAY,MAIZrC,EAAAI,UAAAD,cAAR,WACI,GAAImC,GAAajC,EAAE,uBACnBiC,GAAW9B,KAAK,eAAe+B,GAAG,QAAS,SAAUhC,GACjDA,EAAGiC,oBAEPF,EAAW9B,KAAK,uCAAuCY,KAAK,WACxD,GAAIqB,GAAMpC,EAAEJ,MACRyC,EAAc,WACV,GAAIC,GAAaF,EAAIjC,KAAK,yBAAyBC,KAAK,WAAa,EAAI,CACzEgC,GAAIjC,KAAK,iBAAiBY,KAAK,WAC3B,GAAIwB,GAAOvC,EAAEJ,MAAMY,KAAK,WACxB+B,GAAOA,EAAKC,QAAQ,YAAaF,GACjCtC,EAAEJ,MAAM6C,KAAK,OAAQF,KAGjCH,GAAIjC,KAAK,wBAAwBuC,OAAOL,GAAaM,QAAQ,aAGzEhD,IAEA,IAAIA","file":"MotionList.js","sourcesContent":["/// <reference path=\"../../../typings/colresizable/index.d.ts\" />\n\nclass MotionList {\n    constructor() {\n        this.initList();\n        this.initExportRow();\n    }\n\n    private initList() {\n        $(\".markAll\").click(function (ev) {\n            $(\".adminMotionTable\").find(\"input.selectbox\").prop(\"checked\", true);\n            ev.preventDefault();\n        });\n        $(\".markNone\").click(function (ev) {\n            $(\".adminMotionTable\").find(\"input.selectbox\").prop(\"checked\", false);\n            ev.preventDefault();\n        });\n\n        let $select = $(\"#initiatorSelect\"),\n            initiatorValues = $select.data(\"values\"),\n            matcher = function findMatches(q, cb) {\n                let matches, substrRegex;\n\n                // an array that will be populated with substring matches\n                matches = [];\n\n                // regex used to determine if a string contains the substring `q`\n                substrRegex = new RegExp(q, \"i\");\n\n                // iterate through the pool of strings and for any string that\n                // contains the substring `q`, add it to the `matches` array\n                $.each(initiatorValues, function (i, str) {\n                    if (substrRegex.test(str)) {\n                        // the typeahead jQuery plugin expects suggestions to a\n                        // JavaScript object, refer to typeahead docs for more info\n                        matches.push({value: str});\n                    }\n                });\n                cb(matches);\n            };\n\n        let options: Twitter.Typeahead.Options = {\n            hint: true,\n            highlight: true,\n            minLength: 1\n        };\n        let datasets:Twitter.Typeahead.Dataset<any>[] = [{\n            name: \"supporter\",\n            source: matcher\n        }];\n\n        $select.typeahead<any>(options, datasets);\n\n        $('.adminMotionTable').colResizable({\n            'liveDrag': true,\n            'postbackSafe': true,\n            'minWidth': 30\n        });\n    }\n\n    private initExportRow() {\n        let $exportRow = $(\".motionListExportRow\");\n        $exportRow.find(\"li.checkbox\").on(\"click\", function (ev) {\n            ev.stopPropagation();\n        });\n        $exportRow.find(\".exportMotionDd, .exportAmendmentDd\").each(function () {\n            let $dd = $(this),\n                recalcLinks = function () {\n                    let withdrawn = ($dd.find(\"input[name=withdrawn]\").prop(\"checked\") ? 1 : 0);\n                    $dd.find(\".exportLink a\").each(function () {\n                        let link = $(this).data(\"href-tpl\");\n                        link = link.replace(\"WITHDRAWN\", withdrawn);\n                        $(this).attr(\"href\", link);\n                    });\n                };\n            $dd.find(\"input[type=checkbox]\").change(recalcLinks).trigger(\"change\");\n        });\n    }\n}\n\nnew MotionList();\n"]}