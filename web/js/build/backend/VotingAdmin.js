define(["require","exports"],(function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VotingAdmin=void 0;e.VotingAdmin=class{constructor(t){this.$element=t;const e=this.$element.find(".votingAdmin")[0],n=t.data("voting"),i=t.data("url-vote-settings"),o=t.data("url-poll");this.widget=new Vue({el:e,template:'<div class="adminVotings">\n                <voting-admin-widget v-for="voting in votings"\n                                     :voting="voting"\n                                     @set-status="setStatus"\n                                     @remove-item="removeItem"\n                ></voting-admin-widget>\n            </div>',data:()=>({votings:n,csrf:$("head").find("meta[name=csrf-token]").attr("content"),pollingId:null}),methods:{_performOperation:function(t,e){let n={_csrf:this.csrf};e&&(n=Object.assign(n,e));const o=this,s=i.replace(/VOTINGBLOCKID/,t);$.post(s,n,(function(t){void 0===t.success||t.success?o.votings=t:alert(t.message)})).catch((function(t){alert(t.responseText)}))},setStatus(t,e,n){this._performOperation(t,{op:"update",status:e,organizations:n.map((t=>({id:t.id,members_present:t.members_present})))})},removeItem(t,e,n){this._performOperation(t,{op:"remove-item",itemType:e,itemId:n})},reloadData:function(){const t=this;$.get(o,(function(e){t.votings=e})).catch((function(t){console.error("Could not load voting data from backend",t)}))},startPolling:function(){const t=this;this.pollingId=window.setInterval((function(){t.reloadData()}),3e3)}},beforeDestroy(){window.clearInterval(this.pollingId)},created(){this.startPolling()}})}}}));
//# sourceMappingURL=VotingAdmin.js.map
