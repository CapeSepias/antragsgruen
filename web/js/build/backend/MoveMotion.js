var __awaiter=this&&this.__awaiter||function(t,n,i,e){return new(i||(i=Promise))((function(o,a){function d(t){try{r(e.next(t))}catch(t){a(t)}}function s(t){try{r(e.throw(t))}catch(t){a(t)}}function r(t){var n;t.done?o(t.value):(n=t.value,n instanceof i?n:new i((function(t){t(n)}))).then(d,s)}r((e=e.apply(t,n||[])).next())}))};define(["require","exports"],(function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.MoveMotion=void 0;n.MoveMotion=class{constructor(t){this.$form=t,this.checkBackend=t.data("check-backend"),this.initTarget(),this.initConsultation(),this.initButtonEnabled()}initTarget(){const t=this.$form.find("input[name=target]");t.on("change",(()=>{const n=t.filter(":checked").val();"agenda"===n?this.$form.find(".moveToAgendaItem").removeClass("hidden"):this.$form.find(".moveToAgendaItem").addClass("hidden"),"consultation"===n?this.$form.find(".moveToConsultationItem").removeClass("hidden"):this.$form.find(".moveToConsultationItem").addClass("hidden"),this.rebuildMotionTypes()})).trigger("change")}initConsultation(){$("#consultationId").on("change",this.rebuildMotionTypes.bind(this))}rebuildMotionTypes(){const t=$("#consultationId").val();$(".moveToMotionTypeId").addClass("hidden"),"consultation"===this.$form.find("input[name=target]:checked").val()&&$(".moveToMotionTypeId"+t).removeClass("hidden")}isPrefixAvailable(t,n){return new Promise(((i,e)=>$.get(this.checkBackend,{checkType:"prefix",newMotionPrefix:t,newConsultationId:n}).then((t=>{i(t.success)}))))}rebuildButtonEnabled(){return __awaiter(this,void 0,void 0,(function*(){let t,n=!0;t="consultation"===this.$form.find("input[name=target]:checked").val()&&this.$form.find("[name=consultation]").length>0?parseInt(this.$form.find("[name=consultation]").val()):null;(yield this.isPrefixAvailable(this.$form.find("#motionTitlePrefix").val(),t))?this.$form.find(".prefixAlreadyTaken").addClass("hidden"):(this.$form.find(".prefixAlreadyTaken").removeClass("hidden"),n=!1),this.$form.find("input[name=operation]:checked").val()||(n=!1),this.$form.find("input[name=target]:checked").val()||(n=!1),this.$form.find("button[type=submit]").prop("disabled",!n)}))}initButtonEnabled(){this.$form.find("#motionTitlePrefix").on("change keyup",this.rebuildButtonEnabled.bind(this)),this.$form.find("input[name=operation]").on("change",this.rebuildButtonEnabled.bind(this)),this.$form.find("input[name=target]").on("change",this.rebuildButtonEnabled.bind(this)),$("#consultationId").on("change",this.rebuildButtonEnabled.bind(this)),this.rebuildButtonEnabled()}}}));
//# sourceMappingURL=MoveMotion.js.map
