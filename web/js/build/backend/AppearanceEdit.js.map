{"version":3,"sources":["backend/AppearanceEdit.ts"],"names":["AppearanceEdit","$form","this","initLogoUpload","initLayoutChooser","initTranslationService","initSpeechQueues","$","tooltip","prototype","$logoRow","find","$uploadLabel","on","ev","preventDefault","src","currentTarget","attr","val","length","prepend","removeClass","text","data","path","split","filename","addClass","$inputs","$editLink","editLinkDefault","onChange","$selected","filter","first","replace","_this","prop","trigger","exports"],"mappings":"yGAEA,IAAAA,EAAA,WACI,SAAAA,EAAoBC,GAAAC,KAAAD,MAAAA,EAChBC,KAAKC,iBACLD,KAAKE,oBACLF,KAAKG,yBACLH,KAAKI,mBAELC,EAAE,2BAA2BC,UA2ErC,OAxEYR,EAAAS,UAAAN,eAAR,WACI,IAAMO,EAAWR,KAAKD,MAAMU,KAAK,YAC7BC,EAAeF,EAASC,KAAK,0BACjCD,EAASG,GAAG,QAAS,0BAA2B,SAAAC,GAC5CA,EAAGC,iBACH,IAAMC,EAAMT,EAAEO,EAAGG,eAAeN,KAAK,OAAOO,KAAK,OACjDR,EAASC,KAAK,gCAAgCQ,IAAIH,GACD,IAA7CN,EAASC,KAAK,oBAAoBS,QAClCV,EAASC,KAAK,gBAAgBU,QAAQ,uBAE1CX,EAASC,KAAK,oBAAoBO,KAAK,MAAOF,GAAKM,YAAY,UAC/DV,EAAaW,KAAKX,EAAaY,KAAK,UACpCd,EAASC,KAAK,oBAAoBQ,IAAI,MAE1CT,EAASC,KAAK,oBAAoBE,GAAG,SAAU,WAC3C,IAAMY,EAAQf,EAASC,KAAK,oBAAoBQ,MAAiBO,MAAM,MACjEC,EAAWF,EAAKA,EAAKL,OAAS,GACpCV,EAASC,KAAK,gCAAgCQ,IAAI,IAClDT,EAASC,KAAK,oBAAoBiB,SAAS,UAC3ChB,EAAaW,KAAKI,MAIlB3B,EAAAS,UAAAL,kBAAR,WACI,IAAMyB,EAAU3B,KAAKD,MAAMU,KAAK,oCAC1BmB,EAAY5B,KAAKD,MAAMU,KAAK,kBAC5BoB,EAAkBD,EAAUZ,KAAK,QACjCc,EAAW,WACb,IAAIC,EAAYJ,EAAQK,OAAO,YACN,IAArBD,EAAUb,SACVa,EAAYJ,EAAQM,SAExBL,EAAUZ,KAAK,OAAQa,EAAgBK,QAAQ,UAAWH,EAAUd,SAExEU,EAAQhB,GAAG,SAAUmB,GACrBA,KAGIhC,EAAAS,UAAAJ,uBAAR,WAAA,IAAAgC,EAAAnC,KACIA,KAAKD,MAAMU,KAAK,uBAAuBE,GAAG,SAAU,SAACC,GACjCP,EAAEO,EAAGG,eAAeqB,KAAK,YAErCD,EAAKpC,MAAMU,KAAK,aAAaW,YAAY,UACzCe,EAAKpC,MAAMU,KAAK,mBAAmB2B,KAAK,YAAY,KAEpDD,EAAKpC,MAAMU,KAAK,aAAaiB,SAAS,UACtCS,EAAKpC,MAAMU,KAAK,mBAAmB2B,KAAK,YAAY,MAEzDC,QAAQ,WAGPvC,EAAAS,UAAAH,iBAAR,WAAA,IAAA+B,EAAAnC,KACIA,KAAKD,MAAMU,KAAK,mBAAmBE,GAAG,SAAU,SAACC,GAC7BP,EAAEO,EAAGG,eAAeqB,KAAK,WAErCD,EAAKpC,MAAMU,KAAK,WAAWW,YAAY,UAEvCe,EAAKpC,MAAMU,KAAK,WAAWiB,SAAS,YAEzCW,QAAQ,UAEXrC,KAAKD,MAAMU,KAAK,2BAA2BE,GAAG,SAAU,SAACC,GACrCP,EAAEO,EAAGG,eAAeqB,KAAK,YAErCD,EAAKpC,MAAMU,KAAK,cAAcW,YAAY,UAC1Ce,EAAKpC,MAAMU,KAAK,oBAAoB2B,KAAK,YAAY,KAErDD,EAAKpC,MAAMU,KAAK,cAAciB,SAAS,UACvCS,EAAKpC,MAAMU,KAAK,oBAAoB2B,KAAK,YAAY,MAE1DC,QAAQ,WAEnBvC,EAlFA,GAAawC,EAAAxC,eAAAA","file":"AppearanceEdit.js","sourcesContent":["/// <reference path=\"../typings/fuelux/index.d.ts\" />\n\nexport class AppearanceEdit {\n    constructor(private $form: JQuery) {\n        this.initLogoUpload();\n        this.initLayoutChooser();\n        this.initTranslationService();\n        this.initSpeechQueues();\n\n        $('[data-toggle=\"tooltip\"]').tooltip();\n    }\n\n    private initLogoUpload() {\n        const $logoRow = this.$form.find('.logoRow'),\n            $uploadLabel = $logoRow.find('.uploadCol label .text');\n        $logoRow.on('click', '.imageChooserDd ul    a', ev => {\n            ev.preventDefault();\n            const src = $(ev.currentTarget).find(\"img\").attr(\"src\");\n            $logoRow.find('input[name=consultationLogo]').val(src);\n            if ($logoRow.find('.logoPreview img').length === 0) {\n                $logoRow.find('.logoPreview').prepend('<img src=\"\" alt=\"\">');\n            }\n            $logoRow.find('.logoPreview img').attr('src', src).removeClass('hidden');\n            $uploadLabel.text($uploadLabel.data('title'));\n            $logoRow.find(\"input[type=file]\").val('');\n        });\n        $logoRow.find(\"input[type=file]\").on(\"change\", () => {\n            const path = ($logoRow.find(\"input[type=file]\").val() as string).split('\\\\');\n            const filename = path[path.length - 1];\n            $logoRow.find('input[name=consultationLogo]').val('');\n            $logoRow.find(\".logoPreview img\").addClass('hidden');\n            $uploadLabel.text(filename);\n        });\n    }\n\n    private initLayoutChooser() {\n        const $inputs = this.$form.find(\".thumbnailedLayoutSelector input\");\n        const $editLink = this.$form.find(\".editThemeLink\");\n        const editLinkDefault = $editLink.attr(\"href\");\n        const onChange = () => {\n            let $selected = $inputs.filter(\":checked\");\n            if ($selected.length === 0) {\n                $selected = $inputs.first();\n            }\n            $editLink.attr(\"href\", editLinkDefault.replace(/DEFAULT/, $selected.val() as string));\n        };\n        $inputs.on(\"change\", onChange);\n        onChange();\n    }\n\n    private initTranslationService() {\n        this.$form.find(\"#translationService\").on('change', (ev) => {\n            const checked = $(ev.currentTarget).prop(\"checked\");\n            if (checked) {\n                this.$form.find(\".services\").removeClass(\"hidden\");\n                this.$form.find(\".services input\").prop(\"required\", true);\n            } else {\n                this.$form.find(\".services\").addClass(\"hidden\");\n                this.$form.find(\".services input\").prop(\"required\", false);\n            }\n        }).trigger(\"change\");\n    }\n\n    private initSpeechQueues() {\n        this.$form.find(\"#hasSpeechLists\").on('change', (ev) => {\n            const checked = $(ev.currentTarget).prop(\"checked\");\n            if (checked) {\n                this.$form.find(\".quotas\").removeClass(\"hidden\");\n            } else {\n                this.$form.find(\".quotas\").addClass(\"hidden\");\n            }\n        }).trigger(\"change\");\n\n        this.$form.find(\"#hasMultipleSpeechLists\").on('change', (ev) => {\n            const checked = $(ev.currentTarget).prop(\"checked\");\n            if (checked) {\n                this.$form.find(\".quotaName\").removeClass(\"hidden\");\n                this.$form.find(\".quotaName input\").prop(\"required\", true);\n            } else {\n                this.$form.find(\".quotaName\").addClass(\"hidden\");\n                this.$form.find(\".quotaName input\").prop(\"required\", false);\n            }\n        }).trigger(\"change\");\n    }\n}\n"]}