{"version":3,"sources":["backend/MotionSupporterEdit.ts"],"names":["MotionSupporterEdit","$supporterHolder","this","$sortable","find","length","Sortable","create","draggable","$","click","ev","append","data","preventDefault","on","parents","first","remove","$fullTextHolder","lines","val","split","template","$firstAffectedRow","i","$newEl","$rows","$row","eq","parts","trim","select","focus","scrollintoview","exports"],"mappings":"wGAEA,IAAAA,GAAA,WACI,QAAAA,GAAoBC,GAAAC,KAAAD,iBAAAA,CAChB,IAAIE,GAAYD,KAAKD,iBAAiBG,KAAK,OACvCD,GAAUE,OAAS,GACnBC,SAASC,OAAOJ,EAAU,IAAKK,UAAW,OAG9CC,EAAE,sBAAsBC,MAAM,SAAUC,GACpCR,EAAUS,OAAOH,EAAEP,MAAMW,KAAK,YAC9BF,EAAGG,mBAEPX,EAAUY,GAAG,QAAS,gBAAiB,SAAUJ,GAC7CA,EAAGG,iBACHL,EAAEP,MAAMc,QAAQ,MAAMC,QAAQC,UAGlC,IAAIC,GAAkBV,EAAE,kBACxBR,GAAiBG,KAAK,gBAAgBM,MAAM,WAexC,IAAK,GAdDU,GAAQD,EAAgBf,KAAK,YAAYiB,MAAMC,MAAM,KACrDC,EAAWd,EAAE,sBAAsBI,KAAK,WAYxCW,EAAoB,KACfC,EAAI,EAAGA,EAAIL,EAAMf,OAAQoB,IAC9B,GAAgB,IAAZL,EAAMK,GAAV,CAGA,GAAIC,GAhBY,WAEZ,IAAK,GADDC,GAAQxB,EAAUC,KAAK,QAClBqB,EAAI,EAAGA,EAAIE,EAAMtB,OAAQoB,IAAK,CACnC,GAAIG,GAAOD,EAAME,GAAGJ,EACpB,IAAyC,IAArCG,EAAKxB,KAAK,kBAAkBiB,OAAoD,IAArCO,EAAKxB,KAAK,kBAAkBiB,MAAa,MAAOO,GAGnG,GAAIF,GAASjB,EAAEc,EAEf,OADApB,GAAUS,OAAOc,GACVA,IASX,IADyB,MAArBF,IAA2BA,EAAoBE,GAC/CA,EAAOtB,KAAK,uBAAuBC,OAAS,EAAG,CAC/C,GAAIyB,GAAQV,EAAMK,GAAGH,MAAM,IAC3BI,GAAOtB,KAAK,uBAAuBiB,IAAIS,EAAM,GAAGC,QAC5CD,EAAMzB,OAAS,GACfqB,EAAOtB,KAAK,uBAAuBiB,IAAIS,EAAM,GAAGC,YAGpDL,GAAOtB,KAAK,uBAAuBiB,IAAID,EAAMK,IAGrDN,EAAgBf,KAAK,YAAY4B,SAASC,QAC1CT,EAAkBU,mBAG9B,MAAAlC,KApDamC,GAAAnC,oBAAAA","file":"MotionSupporterEdit.js","sourcesContent":["declare let Sortable: any;\n\nexport class MotionSupporterEdit {\n    constructor(private $supporterHolder: JQuery) {\n        let $sortable = this.$supporterHolder.find(\"> ul\");\n        if ($sortable.length > 0) {\n            Sortable.create($sortable[0], {draggable: 'li'});\n        }\n\n        $(\".supporterRowAdder\").click(function (ev) {\n            $sortable.append($(this).data(\"content\"));\n            ev.preventDefault();\n        });\n        $sortable.on(\"click\", \".delSupporter\", function (ev) {\n            ev.preventDefault();\n            $(this).parents(\"li\").first().remove();\n        });\n\n        let $fullTextHolder = $(\"#fullTextHolder\");\n        $supporterHolder.find(\".fullTextAdd\").click(function () {\n            let lines = $fullTextHolder.find('textarea').val().split(\";\"),\n                template = $(\".supporterRowAdder\").data(\"content\"),\n                getNewElement = function () {\n                    let $rows = $sortable.find(\"> li\");\n                    for (let i = 0; i < $rows.length; i++) {\n                        let $row = $rows.eq(i);\n                        if ($row.find(\".supporterName\").val() == '' && $row.find(\".supporterOrga\").val() == '') return $row;\n                    }\n                    // No empty row found\n                    let $newEl = $(template);\n                    $sortable.append($newEl);\n                    return $newEl;\n                };\n            let $firstAffectedRow = null;\n            for (let i = 0; i < lines.length; i++) {\n                if (lines[i] == '') {\n                    continue;\n                }\n                let $newEl = getNewElement();\n                if ($firstAffectedRow == null) $firstAffectedRow = $newEl;\n                if ($newEl.find('input.supporterOrga').length > 0) {\n                    let parts = lines[i].split(',');\n                    $newEl.find('input.supporterName').val(parts[0].trim());\n                    if (parts.length > 1) {\n                        $newEl.find('input.supporterOrga').val(parts[1].trim());\n                    }\n                } else {\n                    $newEl.find('input.supporterName').val(lines[i]);\n                }\n            }\n            $fullTextHolder.find('textarea').select().focus();\n            $firstAffectedRow.scrollintoview();\n        });\n    }\n}\n"]}