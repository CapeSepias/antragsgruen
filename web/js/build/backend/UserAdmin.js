define(["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserAdmin=void 0;t.UserAdmin=class{constructor(e){this.element=e[0],this.createVueWidget(),$('[data-toggle="tooltip"]').tooltip()}createVueWidget(){const e=this.element.querySelector(".userAdmin"),t=this.element.getAttribute("data-url-user-save"),s=this.element.getAttribute("data-users"),r=this.element.getAttribute("data-groups"),o=this.element.getAttribute("data-url-poll");this.widget=new Vue({el:e,template:'<div class="adminUsers">\n                <user-admin-widget :users="users"\n                                   :groups="groups"\n                                     @save-user="saveUser"\n                ></user-admin-widget>\n            </div>',data:()=>({usersJson:null,users:null,groupsJson:null,groups:null,csrf:document.querySelector("head meta[name=csrf-token]").getAttribute("content"),pollingId:null}),computed:{},methods:{_performOperation:function(e,s){let r={_csrf:this.csrf};s&&(r=Object.assign(r,s));const o=this;$.post(t,r,(function(e){void 0===e.success||e.success?o.votings=e:alert(e.message)})).catch((function(e){alert(e.responseText)}))},saveUser(e){this._performOperation({op:"save-user",userId:e})},setUserGroupsFromJson(e,t){e===this.usersJson&&t===this.groupsJson||(this.users=JSON.parse(e),this.usersJson=e,this.groups=JSON.parse(t),this.groupsJson=t)},reloadData:function(){const e=this;$.get(o,(function(t){e.setUserGroupsFromJson(t)}),"text").catch((function(e){console.error("Could not load voting data from backend",e)}))},startPolling:function(){const e=this;this.pollingId=window.setInterval((function(){e.reloadData()}),3e3)}},beforeDestroy(){window.clearInterval(this.pollingId)},created(){this.setUserGroupsFromJson(s,r),this.startPolling()}})}}}));
//# sourceMappingURL=UserAdmin.js.map
