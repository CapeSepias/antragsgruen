{"version":3,"sources":["frontend/MotionEditForm.ts"],"names":["MotionEditForm","$form","this","$","datetimepicker","locale","attr","format","each","initWysiwyg","bind","initPlainTextFormGroup","$draftHint","draftMotionType","data","draftMotionId","DraftSavingEngine_1","DraftSavingEngine","prototype","i","el","$holder","$textarea","find","editor","AntragsgruenEditor_1","AntragsgruenEditor","parents","submit","parent","val","getEditor","getData","$fieldset","$input","maxLen_1","maxLenSoft_1","$warning_1","$submit_1","first","$currCounter_1","on","currLen","length","text","removeClass","prop","addClass","trigger","exports"],"mappings":"yKAGA,IAAAA,GAAA,WACI,QAAAA,GAAoBC,GAAAC,KAAAD,MAAAA,EAChBE,EAAE,qBAAqBC,gBACnBC,OAAQF,EAAE,QAAQG,KAAK,QACvBC,OAAQ,MAGZJ,EAAE,qBAAqBK,KAAKN,KAAKO,YAAYC,KAAKR,OAClDC,EAAE,0BAA0BK,KAAKN,KAAKS,uBAAuBD,KAAKR,MAElE,IAAIU,GAAaT,EAAE,cACfU,EAAkBD,EAAWE,KAAK,eAClCC,EAAgBH,EAAWE,KAAK,YAEpC,IAAIE,GAAAC,kBAAkBhB,EAAOW,EAAY,UAAYC,EAAkB,IAAME,GA4CrF,MAzCYf,GAAAkB,UAAAT,YAAR,SAAoBU,EAAGC,GACnB,GAAIC,GAAUlB,EAAEiB,GACZE,EAAYD,EAAQE,KAAK,eACzBC,EAAS,GAAIC,GAAAC,mBAAmBJ,EAAUhB,KAAK,MAEnDgB,GAAUK,QAAQ,QAAQC,OAAO,WAC7BN,EAAUO,SAASN,KAAK,YAAYO,IAAIN,EAAOO,YAAYC,cAI3DhC,EAAAkB,UAAAP,uBAAR,SAA+BQ,EAAGC,GAC9B,GAAIa,GAAY9B,EAAEiB,GACdc,EAASD,EAAUV,KAAK,qBAC5B,IAAiC,GAA7BU,EAAUnB,KAAK,WAAiB,CAChC,GAAIqB,GAASF,EAAUnB,KAAK,WACxBsB,GAAa,EACbC,EAAWJ,EAAUV,KAAK,kBAC1Be,EAAUL,EAAUN,QAAQ,QAAQY,QAAQhB,KAAK,uBACjDiB,EAAeP,EAAUV,KAAK,uBAC9BY,GAAS,IACTC,GAAa,EACbD,IAAU,GAGdD,EAAOO,GAAG,eAAgB,WACtB,GAAIC,GAAUR,EAAOJ,MAAMa,MAC3BH,GAAaI,KAAKF,GACdA,EAAUP,GACVE,EAASQ,YAAY,UAChBT,GACDE,EAAQQ,KAAK,YAAY,KAG7BT,EAASU,SAAS,UACbX,GACDE,EAAQQ,KAAK,YAAY,MAGlCE,QAAQ,YAGvBhD,IA1DaiD,GAAAjD,eAAAA","file":"MotionEditForm.js","sourcesContent":["import {DraftSavingEngine} from \"../shared/DraftSavingEngine\";\nimport {AntragsgruenEditor} from \"../shared/AntragsgruenEditor\";\n\nexport class MotionEditForm {\n    constructor(private $form: JQuery) {\n        $(\".input-group.date\").datetimepicker({\n            locale: $(\"html\").attr('lang'),\n            format: 'L'\n        });\n\n        $(\".wysiwyg-textarea\").each(this.initWysiwyg.bind(this));\n        $(\".form-group.plain-text\").each(this.initPlainTextFormGroup.bind(this));\n\n        let $draftHint = $(\"#draftHint\"),\n            draftMotionType = $draftHint.data(\"motion-type\"),\n            draftMotionId = $draftHint.data(\"motion-id\");\n\n        new DraftSavingEngine($form, $draftHint, \"motion_\" + draftMotionType + \"_\" + draftMotionId);\n    }\n\n    private initWysiwyg(i, el) {\n        let $holder = $(el),\n            $textarea = $holder.find(\".texteditor\"),\n            editor = new AntragsgruenEditor($textarea.attr(\"id\"));\n\n        $textarea.parents(\"form\").submit(function () {\n            $textarea.parent().find(\"textarea\").val(editor.getEditor().getData());\n        });\n    }\n\n    private initPlainTextFormGroup(i, el) {\n        let $fieldset = $(el),\n            $input = $fieldset.find(\"input.form-control\");\n        if ($fieldset.data(\"max-len\") != 0) {\n            let maxLen = $fieldset.data(\"max-len\"),\n                maxLenSoft = false,\n                $warning = $fieldset.find('.maxLenTooLong'),\n                $submit = $fieldset.parents(\"form\").first().find(\"button[type=submit]\"),\n                $currCounter = $fieldset.find(\".maxLenHint .counter\");\n            if (maxLen < 0) {\n                maxLenSoft = true;\n                maxLen = -1 * maxLen;\n            }\n\n            $input.on('keyup change', () => {\n                let currLen = $input.val().length;\n                $currCounter.text(currLen);\n                if (currLen > maxLen) {\n                    $warning.removeClass('hidden');\n                    if (!maxLenSoft) {\n                        $submit.prop(\"disabled\", true);\n                    }\n                } else {\n                    $warning.addClass('hidden');\n                    if (!maxLenSoft) {\n                        $submit.prop(\"disabled\", false);\n                    }\n                }\n            }).trigger('change');\n        }\n    }\n}\n"]}