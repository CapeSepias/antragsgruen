define(["require","exports","../shared/DraftSavingEngine","../shared/AntragsgruenEditor"],function(t,e,n,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(e){var a=this;this.$form=e,this.hasChanged=!1,$(".input-group.date").datetimepicker({locale:$("html").attr("lang"),format:"L"}),$(".wysiwyg-textarea").each(this.initWysiwyg.bind(this)),$(".form-group.plain-text").each(this.initPlainTextFormGroup.bind(this));var i=$("#draftHint"),r=i.data("motion-type"),o=i.data("motion-id");new n.DraftSavingEngine(e,i,"motion_"+r+"_"+o),e.on("submit",function(e){var n=!1;a.checkMultipleTagsError()&&(n=!0),n?e.preventDefault():$(window).off("beforeunload",t.onLeavePage)})}return t.prototype.checkMultipleTagsError=function(){var t=this.$form.find(".multipleTagsGroup");return 0!==t.length&&(t.find("input:checked").length>0?(t.removeClass("has-error"),!1):(t.addClass("has-error"),t.scrollintoview({top_offset:-50}),!0))},t.onLeavePage=function(){return __t("std","leave_changed_page")},t.prototype.initWysiwyg=function(e,n){var i=this,r=$(n).find(".texteditor"),o=new a.AntragsgruenEditor(r.attr("id"));r.parents("form").submit(function(){r.parent().find("textarea").val(o.getEditor().getData())}),o.getEditor().on("change",function(){i.hasChanged||(i.hasChanged=!0,$("body").hasClass("testing")||$(window).on("beforeunload",t.onLeavePage))})},t.prototype.initPlainTextFormGroup=function(t,e){var n=$(e),a=n.find("input.form-control");if(0!=n.data("max-len")){var i=n.data("max-len"),r=!1,o=n.find(".maxLenTooLong"),d=n.parents("form").first().find("button[type=submit]"),s=n.find(".maxLenHint .counter");i<0&&(r=!0,i*=-1),a.on("keyup change",function(){var t=a.val().length;s.text(t),t>i?(o.removeClass("hidden"),r||d.prop("disabled",!0)):(o.addClass("hidden"),r||d.prop("disabled",!1))}).trigger("change")}},t}();e.MotionEditForm=i});
//# sourceMappingURL=MotionEditForm.js.map
