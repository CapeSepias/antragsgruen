{"version":3,"sources":["frontend/VotingBlock.ts"],"names":["VotingBlock","$element","this","$vueEl","find","allVotingData","data","pollUrl","voteUrl","votings","console","log","widget","Vue","el","template","methods","vote","votingBlockId","itemType","itemId","arguments","postData","_csrf","$","attr","votes","url","replace","post","catch","err","alert","responseText","exports"],"mappings":"8HAIA,IAAAA,EAGI,SAAoBC,GAAAC,KAAAD,SAAAA,EAChB,IAAME,EAASD,KAAKD,SAASG,KAAK,kBAC5BC,EAAgBJ,EAASK,KAAK,UAC9BC,EAAUN,EAASK,KAAK,YACxBE,EAAUP,EAASK,KAAK,YACxBA,EAAO,CACTG,QAASJ,GAEbK,QAAQC,IAAI,gBAAiBN,EAAeF,GAE5CD,KAAKU,OAAS,IAAIC,IAAI,CAClBC,GAAIX,EAAO,GACXY,SAAU,8LAIVT,KAAIA,EACJU,QAAS,CACLC,KAAM,SAAUC,EAAeC,EAAUC,EAAQH,GAC7CP,QAAQC,IAAIU,WACZX,QAAQC,IAAIJ,GACZG,QAAQC,IAAIH,GACZ,IAAMc,EAAW,CACbC,MAAOC,EAAE,QAAQpB,KAAK,yBAAyBqB,KAAK,WACpDC,MAAO,CAAC,CACJP,SAAQA,EACRC,OAAMA,EACNH,KAAIA,KAGNL,EAASV,KACTyB,EAAMnB,EACPoB,QAAQ,gBAAiBV,GACzBU,QAAQ,WAAYT,GACpBS,QAAQ,SAAUR,GACvBI,EAAEK,KAAKF,EAAKL,EAAU,SAAUhB,GAC5BM,EAAOH,QAAUH,IAClBwB,MAAM,SAAUC,GACfC,MAAMD,EAAIE,qBAzCrBC,EAAAlC,YAAAA","file":"VotingBlock.js","sourcesContent":["import { VueConstructor } from 'vue';\n\ndeclare var Vue: VueConstructor;\n\nexport class VotingBlock {\n    private widget;\n\n    constructor(private $element: JQuery) {\n        const $vueEl = this.$element.find(\".currentVoting\");\n        const allVotingData = $element.data('voting');\n        const pollUrl = $element.data('url-poll');\n        const voteUrl = $element.data('url-vote');\n        const data = {\n            votings: allVotingData,\n        };\n        console.log(\"Voting data: \", allVotingData, $vueEl);\n\n        this.widget = new Vue({\n            el: $vueEl[0],\n            template: `\n                <div class=\"currentVotings\">\n                <voting-block-widget v-for=\"voting in votings\" :voting=\"voting\" @vote=\"vote\"></voting-block-widget>\n                </div>`,\n            data,\n            methods: {\n                vote: function (votingBlockId, itemType, itemId, vote) {\n                    console.log(arguments);\n                    console.log(pollUrl);\n                    console.log(voteUrl);\n                    const postData = {\n                        _csrf: $(\"head\").find(\"meta[name=csrf-token]\").attr(\"content\") as string,\n                        votes: [{\n                            itemType,\n                            itemId,\n                            vote\n                        }]\n                    };\n                    const widget = this;\n                    const url = voteUrl\n                        .replace(/VOTINGBLOCKID/, votingBlockId)\n                        .replace(/ITEMTYPE/, itemType)\n                        .replace(/ITEMID/, itemId);\n                    $.post(url, postData, function (data) {\n                        widget.votings = data;\n                    }).catch(function (err) {\n                        alert(err.responseText);\n                    });\n                }\n            }\n        });\n    }\n}\n"]}