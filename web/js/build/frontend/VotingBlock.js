define(["require","exports"],(function(t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.VotingBlock=void 0;o.VotingBlock=class{constructor(t){this.$element=t;const o=this.$element.find(".currentVoting"),e=t.data("voting"),n=t.data("url-poll"),i=t.data("url-vote");this.widget=new Vue({el:o[0],template:'\n                <div class="currentVotings">\n                <voting-block-widget v-for="voting in votings" :voting="voting" @vote="vote"></voting-block-widget>\n                </div>',data:()=>({votings:e,pollingId:null}),methods:{vote:function(t,o,e,l){console.log(arguments),console.log(n),console.log(i);const c={_csrf:$("head").find("meta[name=csrf-token]").attr("content"),votes:[{itemType:o,itemId:e,vote:l}]},s=this,a=i.replace(/VOTINGBLOCKID/,t).replace(/ITEMTYPE/,o).replace(/ITEMID/,e);$.post(a,c,(function(t){s.votings=t})).catch((function(t){alert(t.responseText)}))},reloadData:function(){const t=this;$.get(n,(function(o){t.votings=o})).catch((function(t){console.error("Could not load voting data from backend",t)}))},startPolling:function(){const t=this;this.pollingId=window.setInterval((function(){t.reloadData()}),3e3)}},beforeDestroy(){window.clearInterval(this.pollingId)},created(){this.startPolling()}})}}}));
//# sourceMappingURL=VotingBlock.js.map
