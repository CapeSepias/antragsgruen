define(["require","exports","../shared/AntragsgruenEditor"],function(i,e,t){"use strict";var o=function(){function i(){var i=this;this.editors=[],this.$form=$("#amendmentMergeForm"),this.$collissionHolder=$(".amendmentCollissionsHolder"),this.$checkCollissions=$(".checkAmendmentCollissions"),this.$affectedParagraphs=$(".affectedParagraphs > .paragraph"),this.$checkCollissions.click(function(e){e.preventDefault(),i.loadCollissions()}),this.$affectedParagraphs.each(function(e,t){i.initAffectedParagraph(t)})}return i.prototype.initAffectedParagraph=function(i){var e=$(i);e.find(".modifySelector input").change(function(){"1"==e.find(".modifySelector input:checked").val()?e.addClass("modified").removeClass("unmodified"):e.removeClass("modified").addClass("unmodified")});var o=e.data("section-id")+"_"+e.data("paragraph-no");this.editors[o]=new t.AntragsgruenEditor(e.find(".affectedBlock > .texteditor").attr("id"))},i.prototype.loadCollissions=function(){var i=this,e=this.$checkCollissions.data("url"),t={};this.$affectedParagraphs.each(function(e,o){var a,s=$(o),n=s.find(".modifySelector input:checked").val(),d=s.data("section-id"),r=s.data("paragraph-no");if(n){console.log(d+"_"+r);var l=i.editors[d+"_"+r].getEditor(),c=l.getData();"undefined"!=typeof l.plugins.lite?(l.plugins.lite.findPlugin(l).acceptAll(),a=l.getData(),l.setData(c)):a=l.getData()}else a=s.data("unchanged-amendment");void 0===t[s.data("section-id")]&&(t[s.data("section-id")]={}),t[s.data("section-id")][s.data("paragraph-no")]=a}),$.post(e,{newSections:t,_csrf:this.$form.find("> input[name=_csrf]").val()},this.collissionsLoaded.bind(this))},i.prototype.collissionsLoaded=function(i){console.log(i),this.$collissionHolder.html(i);var e=this.$collissionHolder.find(".amendmentOverrideBlock > .texteditor");e.length>0&&(e.each(function(i,e){new t.AntragsgruenEditor($(e).attr("id"))}),this.$collissionHolder.scrollintoview({top_offset:-50})),this.$checkCollissions.hide(),$(".saveholder .save").prop("disabled",!1).show()},i}();new o});
//# sourceMappingURL=MergeSingleAmendment.js.map
